<!DOCTYPE html>
<html lang="en">

<script>
    $(document).ready(function () {
        loadManufacturersTable();
    })

    function loadManufacturersTable(){
        $.getJSON("manufacturers", function(data) {
            var table = $('<table id="manufacturersTable"></table>');
            $(table).append('<tr><th>Name</th><th>Country</th><th>Founded</th></tr>');

            $.each(data, function(key, value){
                var row = $('<tr></tr>');
                var nameCell = $('<td id="authorId" onclick="openCar(' +
                    "'" +
                    value.name +
                    "'" +
                    ')">' + value.name + '</td>');
                var countryCell = $('<td>' + value.country + '</td>');
                var foundedCell = $('<td>' + value.founded + '</td>');
                $(row).append(nameCell);
                $(row).append(countryCell);
                $(row).append(foundedCell);
                $(table).append(row);
            })
            $("#content").append(table);
        })
    }

    function addManufacturer(){
        var name = $( "input[name='name']" ).val();
        var country = $( "input[name='country']" ).val();
        var founded = $( "input[name='founded']" ).val();

        if (name == '' || country == '' || founded == '' ) {
            giveMessage("Please fill all the inputs!");
        }
        else{
            var manufacturer = {
                name: name,
                country: country,
                founded: founded
            }
            $.post("addManufacturers",manufacturer)
                .done(function(){
                    giveMessage("The manufacturer: "+name+" successfully added!");
                    $("#manufacturersTable").empty();
                    loadManufacturersTable();
                })
                .fail(function(){
                    giveMessage("The manufacturer: "+name+" is already in the list!");
                })
        }
    }
</script>

<div id="manufacturersFormBanner">
    <div class="formDiv">
        <table class="formBox">
            <td>
                <p class="formTitle" onclick="showForm('manufacturersForm')" >Add manufacturer</p>
                <div id="manufacturersForm">
                    <table>
                        <tr>
                            <td>Name:</td>
                            <td>
                                <input type="text" name="name" autofocus required="required">
                            </td>
                        </tr>
                        <tr>
                            <td>Country:</td>
                            <td>
                                <input type="text" name="country" required="required">
                            </td>
                        </tr>
                        <tr>
                            <td>Founded:</td>
                            <td>
                                <input type="date" name="founded" required="required">
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <button onclick="addManufacturer()">Add Manufacturer</button>
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </table>
    </div>
</div>

</html>