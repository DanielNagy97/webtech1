<!DOCTYPE html>
<html lang="en">

<script>
    $(document).ready(function () {
        loadCarsTable();
        $.getJSON("manufacturerNames", function(data) {
            $.each(data, function(key, value){
                $("#selectManufacturer").append('<option value=' + value + '>' + value + '</option>')
            })
        })
    })

    function loadCarsTable(){
        $.getJSON("cars", function(data) {
            var table = $('<table id="carsTable"></table>');
            $(table).append('<tr><th>Name</th><th>Consumption</th><th>Color</th><th>Manufacturer</th><th>Available</th><th>Year</th><th>Horsepower</th></tr>');

            $.each(data, function(key, value){
                var row = $('<tr></tr>');
                var nameCell = $('<td>' + value.name + '</td>');
                var consumptionCell = $('<td>' + value.consumption + '</td>');
                var colorCell = $('<td>' + value.color + '</td>');
                var manufacturerCell = $('<td id="authorId" onclick="openManufacturer(' +
                    "'" +
                    value.manufacturer +
                    "'" +
                    ')">' + value.manufacturer + '</td>');
                var availableCell = $('<td>' + value.available + '</td>');
                var yearCell = $('<td>' + value.year + '</td>');
                var horsepowerCell = $('<td>' + value.horsepower + '</td>');

                $(row).append(nameCell);
                $(row).append(consumptionCell);
                $(row).append(colorCell);
                $(row).append(manufacturerCell);
                $(row).append(availableCell);
                $(row).append(yearCell);
                $(row).append(horsepowerCell);
                $(table).append(row);
            })
            $("#content").append(table);
        })
    }

    function addCar(){
        var name = $( "input[name='name']" ).val();
        var consumption = $( "input[name='consumption']" ).val();
        var color = $( "input[name='color']" ).val();
        var manufacturer = $( "input[name='manufacturer']" ).val();
        var available = $( "input[name='available']" ).val();
        var year = $( "input[name='year']" ).val();
        var horsepower = $( "input[name='horsepower']" ).val();

        if (name == '' || consumption == '' || color == '' || manufacturer == '' || available == '' || year == '' || horsepower == '') {
            giveMessage("Please fill all the inputs!");
        } else {
            var car = {
                name: name,
                consumption: consumption,
                color: color,
                manufacturer: manufacturer,
                available: available,
                year: year,
                horsepower: horsepower
            }
            $.post("addCar",car)
                .done(function(){
                    giveMessage("The car: "+name+" successfully added!");
                    $("#carsTable").empty();
                    loadCarsTable();
                })
                .fail(function(){
                    giveMessage("The car: "+name+" is already in the list!");
                })
        }
    }




</script>


<div id="carFormBanner">
    <div class="formDiv">
        <table class="formBox">
            <td>
                <div class="formTitle" onclick="showForm('carForm')">Add car</div>
                <div id="carForm">
                    <table>
                        <tr>
                            <td>Name: </td>
                            <td>
                                <input type="text" name="name" required="required" autofocus value="Name">
                            </td>
                        </tr>

                        <tr>
                            <td>Consumption: </td>
                            <td>
                                <input type="text" name="consumption" required="required" value="7/100km">
                            </td>
                        </tr>

                        <tr>
                            <td>Color: </td>
                            <td>
                                <input type="text" name="color" required="required" value="Black">
                            </td>
                        </tr>

                        <tr>
                            <td>Manufacturer:</td>
                            <td>
                                <select id="selectManufacturer" name="manufacturer" required="required">
                                </select>
                            </td>
                        </tr>

                        <td>Available:</td>
                        <td>
                            <input type="number" name="available" required="required" value="1">
                        </td>
                        </tr>

                        </tr>

                        <td>Year:</td>
                        <td>
                            <input type="text" name="year" required="required" value="2000">
                        </td>
                        </tr>

                        </tr>

                        <td>Horsepower:</td>
                        <td>
                            <input type="number" name="horsepower" required="required" value="100">
                        </td>
                        </tr>

                        <tr>
                            <td>
                                <button onclick="addCar()">Add New Car</button>
                            </td>
                        </tr>

                    </table>
                </div>
            </td>
        </table>

    </div>


</div>

</html>


